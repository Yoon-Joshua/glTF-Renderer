# 加载glTF场景

类`Scene`中包含成员属性`components`，其类型为`std::unordered_map<std::type_index, std::vector<std::unique_ptr<Component>>>`，存储了场景中所有的组件。

`Scene`中还包含`Node`层次结构的根节点，组件最终是要挂载到节点`Node`上的，`Scene`拥有所有组件的所有权，层次结构中的`Node`通过引用或指针的形式指定该`Node`所挂在的组件。

场景中的组件类型包括：
* 光源 Light
* 采样器 Sampler
* 图片 Image
* 纹理 Texture
* 材质 Material
* 网格 Mesh
* 子网格 Submesh
* 相机 Camera
* 动画 Animation

## 加载流程

### 检查扩展

### 加载组件至场景

1. 加载光源组件

2. 加载采样器组件

3. 加载图片组件

4. 加载纹理组件

    一个纹理组件由一个图片组件和一个采样器组件构成，因此纹理组件对象中包含了对图片和采样器组件的引用

5. 加载材质组件
    
    材质组件内部引用了纹理组件

6. 加载网格、子网格组件

    网格组件由若干个子网格组成。网格组件和子网格组件都会被加载到场景中，网格组件对象保存了其对应的子网格的引用。

    子网格中存储了顶点数据和顶点索引。在存储顶点数据的时候，按照属性（attribution）存储的，比如说有100个顶点，每个顶点包含位置、法向这2个属性，则子网格组件中保存2个buffer，一个buffer存储100个位置数据，一个buffer存储100个法向数据。通过属性的名字获取buffer对象的句柄。

    子网格组件对象还拥有对材质组件的引用，表示该子网格的材质信息。

7. 加载相机

### 创建节点

创建所有节点（除了根节点），然后在每一个节点中挂载相应的网格、相机和光源组件。

注意，此时节点之间的层次信息还没有被创建。

### 加载场景层次信息

创建场景的根节点，创建所有节点的层次信息，将包含所有节点的列表加载到场景中，保存在`Scene`对象的成员变量`nodes`中。如果场景中没有光源或相机，则需要创建并加载默认的光源或相机节点。


# 着色器与场景

顶点着色器中，输入的顶点属性的名字必须与glTF中的属性名字保持一致，这样才能够将网格的顶点属性缓冲绑定的正确的位置上。


